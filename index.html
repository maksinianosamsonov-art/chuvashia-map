<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–ß—É–≤–∞—à–∏—è ‚Äî –¢–æ—á–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background: #121212; /* —Ç—ë–º–Ω—ã–π —Ñ–æ–Ω –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ */
      overflow: hidden;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    .leaflet-container {
      background: #121212 !important;
    }
    #mask-svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- SVG-–º–∞—Å–∫–∞ -->
  <svg id="mask-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
    <defs>
      <clipPath id="chuvashia-clip">
        <!-- –ö–æ–Ω—Ç—É—Ä –ß—É–≤–∞—à–∏–∏ –≤ –≤–∏–¥–µ path -->
        <path d="M47.228,55.998 C47.310,56.021 47.412,56.033 47.520,56.040 C47.630,56.038 47.720,56.025 47.810,56.000 C47.890,55.965 47.950,55.920 48.010,55.870 C48.060,55.810 48.100,55.750 48.130,55.680 C48.150,55.610 48.160,55.540 48.165,55.470 C48.160,55.400 48.145,55.330 48.120,55.260 C48.090,55.190 48.050,55.120 48.000,55.050 C47.940,54.980 47.870,54.920 47.790,54.860 C47.700,54.810 47.600,54.760 47.500,54.720 C47.390,54.690 47.280,54.670 47.170,54.660 C47.060,54.660 46.950,54.670 46.840,54.690 C46.740,54.720 46.640,54.760 46.550,54.810 C46.470,54.860 46.400,54.920 46.340,54.980 C46.290,55.050 46.250,55.120 46.220,55.190 C46.200,55.260 46.190,55.330 46.190,55.400 C46.200,55.470 46.220,55.540 46.250,55.610 C46.290,55.680 46.340,55.750 46.400,55.810 C46.470,55.870 46.550,55.920 46.640,55.965 C46.740,56.000 46.840,56.025 46.950,56.038 C47.060,56.040 47.170,56.033 47.228,55.998 Z" />
      </clipPath>
    </defs>
  </svg>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
      tg.disableVerticalSwipes();
    }

    // === –ì–†–ê–ù–ò–¶–ê –ß–£–í–ê–®–ò–ò (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ bounds) ===
    const chuvashiaCoords = [
      [47.228, 55.998],
      [47.310, 56.021],
      [47.412, 56.033],
      [47.520, 56.040],
      [47.630, 56.038],
      [47.720, 56.025],
      [47.810, 56.000],
      [47.890, 55.965],
      [47.950, 55.920],
      [48.010, 55.870],
      [48.060, 55.810],
      [48.100, 55.750],
      [48.130, 55.680],
      [48.150, 55.610],
      [48.160, 55.540],
      [48.165, 55.470],
      [48.160, 55.400],
      [48.145, 55.330],
      [48.120, 55.260],
      [48.090, 55.190],
      [48.050, 55.120],
      [48.000, 55.050],
      [47.940, 54.980],
      [47.870, 54.920],
      [47.790, 54.860],
      [47.700, 54.810],
      [47.600, 54.760],
      [47.500, 54.720],
      [47.390, 54.690],
      [47.280, 54.670],
      [47.170, 54.660],
      [47.060, 54.660],
      [46.950, 54.670],
      [46.840, 54.690],
      [46.740, 54.720],
      [46.640, 54.760],
      [46.550, 54.810],
      [46.470, 54.860],
      [46.400, 54.920],
      [46.340, 54.980],
      [46.290, 55.050],
      [46.250, 55.120],
      [46.220, 55.190],
      [46.200, 55.260],
      [46.190, 55.330],
      [46.190, 55.400],
      [46.200, 55.470],
      [46.220, 55.540],
      [46.250, 55.610],
      [46.290, 55.680],
      [46.340, 55.750],
      [46.400, 55.810],
      [46.470, 55.870],
      [46.550, 55.920],
      [46.640, 55.965],
      [46.740, 56.000],
      [46.840, 56.025],
      [46.950, 56.038],
      [47.060, 56.040],
      [47.170, 56.033],
      [47.228, 55.998]
    ];

    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ö–ê–†–¢–´ ===
    try {
      const map = L.map('map', {
        minZoom: 8,
        maxZoom: 17,
        zoomControl: true,
        dragging: true,
        scrollWheelZoom: false,
        doubleClickZoom: false
      });

      // –¶–µ–Ω—Ç—Ä –ø–æ –≥—Ä–∞–Ω–∏—Ü–µ
      const bounds = L.latLngBounds(chuvashiaCoords);
      map.fitBounds(bounds, { padding: [30, 30] });

      // üåë –¢–Å–ú–ù–ê–Ø –ö–ê–†–¢–ê ‚Äî MapTiler Streets Dark
      const MAPTILER_API_KEY = 'your_api_key_here_123abc';
      L.tileLayer(`https://api.maptiler.com/maps/streets-dark/{z}/{x}/{y}.png?key=${MAPTILER_API_KEY}`, {
        attribution: '<a href="https://www.maptiler.com/copyright/">¬© MapTiler</a> <a href="https://www.openstreetmap.org/copyright">¬© OpenStreetMap contributors</a>',
        maxZoom: 17
      }).addTo(map);

      // –ó–ê–©–ò–¢–ê –û–¢ –í–´–•–û–î–ê –ó–ê –ü–†–ï–î–ï–õ–´
      map.setMaxBounds(bounds);
      map.on('drag', () => map.panInsideBounds(bounds, { animate: false }));

      // üñºÔ∏è –ü—Ä–∏–º–µ–Ω—è–µ–º SVG-–º–∞—Å–∫—É –∫ –∫–∞—Ä—Ç–µ
      const maskSvg = document.getElementById('mask-svg');
      const svgNS = "http://www.w3.org/2000/svg";

      // –°–æ–∑–¥–∞—ë–º path –¥–ª—è SVG
      const path = document.createElementNS(svgNS, "path");
      path.setAttribute("d", "M" + chuvashiaCoords.map(c => `${c[0]},${c[1]}`).join(" L") + " Z");

      // –ü–æ–ª—É—á–∞–µ–º bounding box –∫–∞—Ä—Ç—ã
      const container = map.getContainer();
      const bbox = container.getBoundingClientRect();

      // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º SVG –ø–æ–¥ —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã
      const scaleX = bbox.width / 100;
      const scaleY = bbox.height / 100;

      // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Å–∫—É
      const clipPath = document.createElementNS(svgNS, "clipPath");
      clipPath.id = "chuvashia-clip";
      clipPath.appendChild(path);
      maskSvg.querySelector("defs").appendChild(clipPath);

      // –ü—Ä–∏–º–µ–Ω—è–µ–º clip-path –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –∫–∞—Ä—Ç—ã
      container.style.clipPath = "url(#chuvashia-clip)";

    } catch (e) {
      console.error("–û—à–∏–±–∫–∞:", e);
      document.body.innerHTML = "<h2>–ö–∞—Ä—Ç–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å</h2>";
    }
  </script>
</body>
</html>

