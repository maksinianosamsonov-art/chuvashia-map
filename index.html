<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>–û–∫—Å–∞–Ω–∞: –ì–æ–Ω–∫–∏, –ú–µ–º—ã –∏ –ú–∏—Å—Å–∏–∏</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg-dark: #0a0e21;
      --neon-pink: #ff00ff;
      --neon-green: #00ff88;
      --text-white: #ffffff;
      --card-bg: #14182b;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: var(--bg-dark);
      color: var(--text-white);
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }

    #app {
      width: 100%;
      max-width: 500px;
      height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    /* –ù–µ–æ–Ω–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã */
    .neon-border {
      box-shadow: 0 0 10px var(--neon-pink), inset 0 0 10px rgba(255, 0, 255, 0.3);
      border: 2px solid var(--neon-pink);
    }

    .neon-text {
      text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink);
      color: var(--neon-pink);
    }

    .glow-green {
      text-shadow: 0 0 10px var(--neon-green);
      color: var(--neon-green);
    }

    /* –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ */
    #loading {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-dark);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.5s ease-out;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 0, 255, 0.3);
      border-top: 4px solid var(--neon-pink);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω */
    #main-screen {
      display: flex;
      flex-direction: column;
      height: 100%;
      padding: 20px;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s ease-out, transform 0.5s ease-out;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(45deg, var(--neon-pink), var(--neon-green));
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      font-size: 20px;
    }

    .stats {
      display: flex;
      gap: 15px;
    }

    .stat-item {
      background: var(--card-bg);
      padding: 8px 12px;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 60px;
    }

    .stat-value {
      font-size: 16px;
      font-weight: bold;
      color: var(--neon-green);
    }

    .stat-label {
      font-size: 12px;
      opacity: 0.7;
    }

    .oksana-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 20px 0;
    }

    .oksana-sprite {
      width: 200px;
      height: 200px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 60px;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    .dialog-box {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 20px;
      margin: 20px 0;
      position: relative;
      border-left: 4px solid var(--neon-pink);
    }

    .dialog-box::before {
      content: "";
      position: absolute;
      top: -10px;
      left: 20px;
      width: 0;
      height: 0;
      border-left: 10px solid transparent;
      border-right: 10px solid transparent;
      border-bottom: 10px solid var(--card-bg);
    }

    .dialog-text {
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 15px;
    }

    .memes-gallery {
      display: flex;
      gap: 10px;
      margin: 15px 0;
      overflow-x: auto;
      padding: 10px 0;
    }

    .meme-item {
      min-width: 80px;
      height: 80px;
      background: rgba(255, 0, 255, 0.1);
      border: 2px solid var(--neon-pink);
      border-radius: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 12px;
      text-align: center;
      padding: 5px;
    }

    .actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .btn {
      flex: 1;
      padding: 15px;
      border: none;
      border-radius: 15px;
      font-weight: bold;
      font-size: 16px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 15px var(--neon-pink);
    }

    .btn-primary {
      background: linear-gradient(45deg, var(--neon-pink), #ff66ff);
      color: white;
    }

    .btn-secondary {
      background: var(--card-bg);
      color: var(--neon-green);
      border: 2px solid var(--neon-green);
    }

    /* –ú–∏–Ω–∏-–∏–≥—Ä–∞ –ü–∞–∑–ª */
    #puzzle-screen {
      display: none;
      flex-direction: column;
      height: 100%;
      padding: 20px;
    }

    .puzzle-header {
      text-align: center;
      margin-bottom: 20px;
    }

    .puzzle-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 5px;
      margin: 20px 0;
      flex: 1;
    }

    .puzzle-piece {
      background: var(--card-bg);
      border: 2px solid var(--neon-pink);
      border-radius: 8px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 24px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .puzzle-piece:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px var(--neon-pink);
    }

    .puzzle-piece.correct {
      background: var(--neon-green);
      color: black;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è Telegram */
    .tg-theme-bg {
      background: var(--bg-dark) !important;
    }

    .tg-theme-text {
      color: var(--text-white) !important;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading">
      <div class="spinner"></div>
      <div class="neon-text">–ó–∞–≥—Ä—É–∑–∫–∞ –û–∫—Å–∞–Ω—ã...</div>
    </div>

    <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="main-screen">
      <div class="header">
        <div class="avatar">–û</div>
        <div class="stats">
          <div class="stat-item">
            <div class="stat-value" id="coins">100</div>
            <div class="stat-label">–ú–æ–Ω–µ—Ç—ã</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="level">1</div>
            <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="day">1</div>
            <div class="stat-label">–î–µ–Ω—å</div>
          </div>
        </div>
      </div>

      <div class="oksana-container">
        <div class="oksana-sprite">üë©‚Äçüé§</div>
      </div>

      <div class="dialog-box">
        <div class="dialog-text" id="dialog-text">
          –ü—Ä–∏–≤–µ—Ç! –Ø –û–∫—Å–∞–Ω–∞ –∏–∑ –ß–µ–±–æ–∫—Å–∞—Ä! –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –º–Ω–µ —Å–æ–±—Ä–∞—Ç—å –ø–∞–∑–ª –∏–∑ –º–æ–µ–≥–æ —Ñ–æ—Ç–æ?
          –≠—Ç–æ –ø–µ—Ä–≤—ã–π —à–∞–≥ –∫ –Ω–∞—à–µ–º—É –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—é!
        </div>
        <div class="memes-gallery">
          <div class="meme-item">"I'm ready"</div>
          <div class="meme-item">"This is fine"</div>
          <div class="meme-item">"When you see"</div>
        </div>
      </div>

      <div class="actions">
        <button class="btn btn-primary" id="start-puzzle">–°–æ–±—Ä–∞—Ç—å –ø–∞–∑–ª</button>
        <button class="btn btn-secondary" id="view-leaderboard">–õ–∏–¥–µ—Ä—ã</button>
      </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω –º–∏–Ω–∏-–∏–≥—Ä—ã –ü–∞–∑–ª -->
    <div id="puzzle-screen">
      <div class="puzzle-header">
        <h2 class="neon-text">–î–µ–Ω—å 1: –°–æ–±–µ—Ä–∏ –ø–∞–∑–ª!</h2>
        <p>–†–∞—Å—Å—Ç–∞–≤—å —á–∞—Å—Ç–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ</p>
      </div>
      
      <div class="puzzle-grid" id="puzzle-grid">
        <!-- –ü–∞–∑–ª –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
      </div>

      <div class="actions">
        <button class="btn btn-secondary" id="back-to-main">–ù–∞–∑–∞–¥</button>
        <button class="btn btn-primary" id="check-puzzle">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // –ò–º–∏—Ç–∞—Ü–∏—è Telegram WebApp
    const Telegram = window.Telegram || {
      WebApp: {
        initData: null,
        initDataUnsafe: { user: { id: 123456789, first_name: "–ò–≥—Ä–æ–∫" } },
        ready: () => {},
        expand: () => {},
        MainButton: {
          setText: () => {},
          show: () => {}
        }
      }
    };

    // –ò–≥—Ä–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    const gameState = {
      currentScreen: 'main',
      day: 1,
      coins: 100,
      level: 1,
      completedPuzzles: [],
      collectedMemes: ['im_ready', 'this_is_fine', 'when_you_see']
    };

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const elements = {
      loading: document.getElementById('loading'),
      mainScreen: document.getElementById('main-screen'),
      puzzleScreen: document.getElementById('puzzle-screen'),
      dialogText: document.getElementById('dialog-text'),
      coins: document.getElementById('coins'),
      level: document.getElementById('level'),
      day: document.getElementById('day'),
      startPuzzle: document.getElementById('start-puzzle'),
      viewLeaderboard: document.getElementById('view-leaderboard'),
      backToMain: document.getElementById('back-to-main'),
      checkPuzzle: document.getElementById('check-puzzle'),
      puzzleGrid: document.getElementById('puzzle-grid')
    };

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    function initApp() {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();
      
      // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
      setTimeout(() => {
        elements.loading.style.opacity = '0';
        setTimeout(() => {
          elements.loading.style.display = 'none';
          elements.mainScreen.style.opacity = '1';
          elements.mainScreen.style.transform = 'translateY(0)';
        }, 500);
      }, 2000);

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
      updateUI();

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      elements.startPuzzle.addEventListener('click', showPuzzleScreen);
      elements.backToMain.addEventListener('click', showMainScreen);
      elements.checkPuzzle.addEventListener('click', checkPuzzle);
      elements.viewLeaderboard.addEventListener('click', showLeaderboard);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    function updateUI() {
      elements.coins.textContent = gameState.coins;
      elements.level.textContent = gameState.level;
      elements.day.textContent = gameState.day;
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
    function showMainScreen() {
      elements.puzzleScreen.style.display = 'none';
      elements.mainScreen.style.display = 'flex';
      gameState.currentScreen = 'main';
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –ø–∞–∑–ª–∞
    function showPuzzleScreen() {
      elements.mainScreen.style.display = 'none';
      elements.puzzleScreen.style.display = 'flex';
      gameState.currentScreen = 'puzzle';
      generatePuzzle();
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞–∑–ª–∞
    function generatePuzzle() {
      elements.puzzleGrid.innerHTML = '';
      const pieces = [1, 2, 3, 4, 5, 6, 7, 8, 9];
      const shuffled = [...pieces].sort(() => Math.random() - 0.5);
      
      shuffled.forEach((num, index) => {
        const piece = document.createElement('div');
        piece.className = 'puzzle-piece';
        piece.textContent = num;
        piece.dataset.correctPosition = num - 1;
        piece.dataset.currentPosition = index;
        piece.addEventListener('click', () => swapPieces(piece));
        elements.puzzleGrid.appendChild(piece);
      });
    }

    // –û–±–º–µ–Ω –ø–∞–∑–ª–∞–º–∏
    let selectedPiece = null;
    function swapPieces(clickedPiece) {
      if (!selectedPiece) {
        selectedPiece = clickedPiece;
        clickedPiece.style.backgroundColor = 'var(--neon-green)';
        clickedPiece.style.color = 'black';
        return;
      }

      if (selectedPiece === clickedPiece) {
        selectedPiece.style.backgroundColor = '';
        selectedPiece.style.color = '';
        selectedPiece = null;
        return;
      }

      // –û–±–º–µ–Ω –º–µ—Å—Ç–∞–º–∏
      const tempPos = selectedPiece.dataset.currentPosition;
      selectedPiece.dataset.currentPosition = clickedPiece.dataset.currentPosition;
      clickedPiece.dataset.currentPosition = tempPos;

      // –û–±–º–µ–Ω –≤ DOM
      const parent = elements.puzzleGrid;
      const selectedIndex = Array.from(parent.children).indexOf(selectedPiece);
      const clickedIndex = Array.from(parent.children).indexOf(clickedPiece);
      
      const temp = parent.children[selectedIndex].outerHTML;
      parent.children[selectedIndex].outerHTML = parent.children[clickedIndex].outerHTML;
      parent.children[clickedIndex].outerHTML = temp;

      // –ü–µ—Ä–µ–ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      generatePuzzle();

      selectedPiece = null;
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–∑–ª–∞
    function checkPuzzle() {
      const pieces = document.querySelectorAll('.puzzle-piece');
      let isCorrect = true;
      
      pieces.forEach((piece, index) => {
        if (parseInt(piece.dataset.correctPosition) !== index) {
          isCorrect = false;
        }
      });

      if (isCorrect) {
        // –ü–∞–∑–ª —Ä–µ—à–µ–Ω
        gameState.coins += 50;
        gameState.completedPuzzles.push(gameState.day);
        updateUI();
        
        elements.dialogText.textContent = '–û—Ç–ª–∏—á–Ω–æ! –¢—ã —Å–æ–±—Ä–∞–ª –ø–∞–∑–ª! –ü–æ–ª—É—á–∞–π 50 –º–æ–Ω–µ—Ç –∏ –¥–æ—Å—Ç—É–ø –∫ –≥–æ–Ω–∫–∞–º!';
        showMainScreen();
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é —É—Å–ø–µ—Ö–∞
        showSuccessAnimation();
      } else {
        alert('–ï—â–µ –Ω–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π –µ—â–µ —Ä–∞–∑!');
      }
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
    function showSuccessAnimation() {
      const success = document.createElement('div');
      success.innerHTML = 'üéâ –£–†–ê! –ü–ê–ó–õ –°–û–ë–†–ê–ù! üéâ';
      success.style.position = 'fixed';
      success.style.top = '50%';
      success.style.left = '50%';
      success.style.transform = 'translate(-50%, -50%)';
      success.style.backgroundColor = 'var(--neon-green)';
      success.style.color = 'black';
      success.style.padding = '20px';
      success.style.borderRadius = '20px';
      success.style.fontSize = '24px';
      success.style.zIndex = '1000';
      success.style.animation = 'fadeIn 0.5s, fadeOut 0.5s 2s';
      
      document.body.appendChild(success);
      setTimeout(() => {
        document.body.removeChild(success);
      }, 2500);
    }

    // –ü–æ–∫–∞–∑–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤
    function showLeaderboard() {
      alert('–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤:\n1. –û–∫—Å–∞–Ω–∞ - 1000 –æ—á–∫–æ–≤\n2. –ò–≥—Ä–æ–∫ - 100 –æ—á–∫–æ–≤\n3. –î—Ä—É–≥ –û–∫—Å–∞–Ω—ã - 50 –æ—á–∫–æ–≤');
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>

